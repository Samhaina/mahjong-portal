{% extends 'base.html' %}
{% load i18n %}

{% block title %}
    {% trans 'About' %}
{% endblock %}

{% block meta_tags %}
    <meta name="description" content="Еще одна версия турнирного рейтинга России по риичи маджонгу.">
    <meta property="og:description" content="Еще одна версия турнирного рейтинга России по риичи маджонгу.">
{% endblock %}

{% block content %}
    <div>
        
        <p>На данный момент мы поддерживаем три рейтинга:</p>
        <ol>
            <li><a href="#rr">Внутренний рейтинг (RR)</a></li>
            <li><a href="#crr">Общий рейтинг (CRR)</a></li>
            <li><a href="#online">Онлайн рейтинг</a></li>
        </ol>

        <h1 id="rr">Внутренний рейтинг (RR)</h1>
        <p>Во внутренний российский рейтинг игроков в риичи маджонг (далее RR) попадают турниры, прошедшие за последние два года. До 2018 года в зачет идут все турниры на 16+ игроков, а начиная с 2018 года - только турниры на 16+ игроков и 4+ ханчана, аккредитованные Федерацией Маджонга (подробнее в разделе "Требования к турнирам").</p>
        <p>С января 2018 года на основании RR определяются игроки, которые смогут принять участие в чемпионатах Европы и Мира.</p>

        <h2>Формула расчета</h2>
        <p>Формула расчета RR базируется на формуле расчета рейтинга EMA 2018 года, однако имеет ряд отличий, которые призваны устранить имеющиеся недостатки EMA-рейтинга и сделать рейтинг более подходящим российским условиям.</p>
        <p>Расчеты рейтинга состоят из двух частей.</p>

        <h3>Первая часть</h3>
        <p>Формула расчета первой части:</p>
        <p><code>A = (W1*R1*A1 + … ) / (W1*A1 + …)</code></p>
        <p>Где W = вес турнира, R = базовый ранг игрока по результатам турнира, A = коэффициент устаревания турнира.</p>
        <p>Схемы расчета коэффициентов W, R и A представлены далее.</p>
        <p>Если игрок сыграл меньше 5 турниров, то для всех недостающих турниров в формулу подставляются нулевые значения в числитель и единица - в знаменатель. Таким образом, игрок получает максимальный результат в первой части формулы, сыграв 5 и больше турниров.</p>
        <p>Если игрок сыграл больше 5 турниров, то в первую часть идут 5 + 80% оставшихся его лучших турниров с округлением в большую сторону. Это позволяет не учитывать самые плохие результаты для игроков, активно принимающих участие в турнирах.</p>
        <p><i>Пример выбора количества турниров:</i></p>
        <ul>
            <li><i>5 и меньше турниров. Все результаты идут в зачет</i></li>
            <li><i>10 турниров. 9 лучших результатов идут в зачет (5+5*80%=9)</i></li>
            <li><i>11 турниров. 10 лучших результатов идут в зачет (5+6*80%=10)</i></li>
            <li><i>15 турниров. 13 лучших результатов идут в зачет (5+10*80%=13)</i></li>
            <li><i>20 турниров. 17 лучших результатов идут в зачет (5+15*80%=17)</i></li>
            <li><i>25 турниров. 21 лучший результат идет в зачет (5+20*80%=21)</i></li>
        </ul>

        <h3>Вторая часть</h3>
        <p>Вторая часть формулы - это четыре лучших турнира игрока за последние два года (лучшие по произведению базового ранга игрока в турнире, коэффициента турнира и коэффициента устаревания), рассчитанные по формуле:</p>
        <p><code>B = (W1*R1*A1 + W2*R2*A2 + W3*R3*A3 + W4*R4*A4) / [MAXK1 + MAXK2 + MAXK3 + MAXK4])</code></p>
        <p>Где MAXK1..4 - четыре максимальных коэффициента турниров, выбранные из всех турниров, прошедших за последние 2 года (с учетом устаревания). Эти коэффициенты одинаковы для всех игроков.</p>

        <h3>Окончательный результат</h3>
        <p>Обе части (A и B) умножаются на 0.5 и суммируются.</p>
        <p><code>рейтинг = A * 0.5 + B * 0.5</code></p>

        <h2>Требования к турнирам</h2>
        <p>С 2018 года турнир может быть учтен в RR только если он удовлетворяет следующим требованиям:</p> 
        <p>Количество игроков: минимум 16</p>
        <p>Количество ханчанов: минимум 4</p>
        <p>Наличие <a href="https://mahjong.click/ru/tournaments/new/">аккредитации Федерации маджонга</a></p>
        <p>Турнир должен быть открытым. Открытый турнир - турнир, в котором как минимум половина мест доступна для открытой регистрации (доступна любому игроку), либо как минимум половина мест распределяется на основании результатов отборочного тура (квалификации), проводимого перед турниром. Квалификация может быть заменой открытой регистрации. Регистрация на квалификацию должна быть открытой для любого игрока.</p>
        <p>Официальные зарубежные ЕМА турниры также идут в RR, если в них участвовал игрок из России.</p>
        <p>Клубные зарубежные турниры (без аккредитации ЕМА) не учитываются.</p>

        <h2>Требования к игрокам</h2>
        <p>В рейтинге RR отображаются игроки, сыгравшие минимум два турнира, коэффициент устаревания которых больше ноля.</p>

        <h2>Базовый ранг игрока</h2>
        <p>В формуле расчета рейтинга ранг определен как R.</p>
        <p>Турнирные результаты игрока всегда находятся между 0 и 1000 и рассчитываются по алгоритму:</p>
        <ol>
            <li>Из количества всех игроков турнира отнять место игрока</li>
            <li>Разделить на (общее количество игроков - 1)</li>
            <li>Умножить на 1000</li>
        </ol>
        <p><i>В частности: за первое место игрок получает 1000, за последнее место 0.</i></p>
        <p><i>Например, в турнире с 100 участвующими игрок занял 25 место. </i></p>
        <p><i><code>Базовый ранг = ((100 - 25) / (100 - 1)) * 1000 = 757</code></i></p>
        <p>При расчёте базового ранга игрока количество всех игроков турнира включает в себя игроков замены</p>

        <h2>Турнирный коэффициент</h2>
        <p>В формуле расчета рейтинга турнирный коэффициент определен как W.</p>
        <p>Турнирный коэффициент повышается за счет следующих факторов:</p>
        <ol>
            <li>Количество ханчанов турнира.</li>
            <li>Количество игроков турнира.</li>
        </ol>
        <p><code>K<sub>турнира</sub> = K<sub>количество ханчанов</sub> + K<sub>количество игроков</sub></code></p>

        <h3>Количество ханчанов</h3>
        <p>Базовый коэффициент равен 0.</p>
        <p>Чем больше дистанция турнира, тем меньше влияние на результаты турнира элементов случайности и больше влияние силы игрока. В связи с этим коэффициент турнира растет в зависимости от числа ханчанов в этом турнире.</p>
        <p>Первые 8 ханчанов увеличивают коэффициент на 0.20 каждый ханчан.</p>
        <p>С 9 по 12 ханчан включительно коэффициент увеличивается на 0.15 за каждый ханчан.</p>
        <p>С 13 по 16 ханчан включительно коэффициент увеличивается на 0.10 за каждый ханчан.</p>
        <p>С 17 по 20 ханчан включительно коэффициент увеличивается на 0.05 за каждый ханчан.</p>
        <p>После 20 ханчанов коэффициент фиксированный и равен 2.8.</p>
        <p><i>Например, турнир с 10 ханчанами получит дополнительный коэффициент 8 * 0.20 за первые 8 ханчанов и 2 * 0.15 за оставшиеся 2 ханчана.<i></p>
        <p><i><code>K<sub>количество ханчанов</sub> = 8 * 0.2 + 2 * 0.15 = 1.9</code></i></p>

        <h3>Количество игроков</h3>
        <p>Базовый коэффициент равен 0.</p>
        <p>Крупные турниры привлекают сильных игроков, и потому чем крупнее турнир, тем ценнее хороший результат в таком турнире. В связи с этим коэффициент турнира растет в зависимости от количества игроков.</p>
        <p>Для первых 80 игроков турнира коэффициент увеличивается на 0.1 за каждых 4-х игроков.</p>
        <p>С 81 по 160 игроков турнира коэффициент увеличивается на 0.05 за каждых 4-х игроков.</p>
        <p>После 160 игроков, коэффициент фиксированный и равен 3.</p>
        <p><i>Например, турнир со 100 участниками получит дополнительный коэффициент (80 / 4) * 0.1 за первых 80 игроков и (20 / 4) * 0.05 за оставшихся 20 игроков.</i></p>
        <p><i><code>K<sub>количество игроков</sub> = (80 / 4) * 0.1 + (20 / 4) * 0.05 = 20 * 0.1 + 5 * 0.05 = 2.25</code></i></p>
        <p>При расчёте коэффициента турнира количество всех игроков турнира включает в себя игроков замены</p>

        <h2>Угасание результатов</h2>
        <p>В формуле расчета рейтинга возраст турнира определен как A.</p>
        <p>Результаты турниров, проведенных за последние 12 месяцев, считаются актуальными и учитываются полностью. Далее турнир устаревает на 33% каждые 6 месяцев. Таким образом в зачет идут только турниры, сыгранные за последние 2 года.</p>

        <h3>Коэффициент турниров с отсечением</h3>
        <p>Для турниров с отсечениями коэффициент W считается по особой формуле. Этот коэффициент может быть различным для игроков турнира и зависит от того, до какого этапа каждый из игроков дошел.</p>
        <p><code>W = K<sub>количество игроков</sub> + K<sub>усредненное количество ханчанов</sub></code></p>
        <p>K<sub>количество игроков</sub> вычисляется так же, как для обычных турниров. Здесь количество игроков равно количеству игроков первого этапа турнира (без учета квалификации, если она есть).</p>
        <p>K<sub>усредненное количество ханчанов</sub> вычисляется как среднее арифметическое между коэффициентом турнира по числу ханчанов, которые отыграл конкретный участник, и средним весом турнира по числу ханчанов W<sub>среднее по числу ханчанов</sub>. В свою очередь W<sub>среднее по числу ханчанов</sub> вычисляется как взвешенное среднее по числу ханчанов для каждого из игроков.</p>
        <p><i>Примеры:</i></p>
        <p><i>1. Турнир для 28 игроков проходит в 2 этапа. Первый этап длится 10 ханчанов. Во второй этап проходят 8 игроков, показавших лучшие результаты в первом. Второй этап также длится 10 ханчанов. Для такого турнира вычисления коэффициента будут вестись следующим образом:</i></p>
        <p><i>Коэффициент турнира для 10 ханчанов равен <code>1.9</code>, для 20 он равен <code>2.8</code>. Тогда <code>W<sub>среднее по числу ханчанов</sub> = (1.9 * 20 + 2.8 * 8) / 28 = 2.16</code>.</i></p>
        <p><i>Для игроков, не прошедших во второй этап, <code>K<sub>усредненное количество ханчанов</sub> = (K<sub>10 ханчанов</sub> + W<sub>среднее по числу ханчанов</sub>) / 2 = (1.9 + 2.16) / 2 = 2.03</code>.</i></p>
        <p><i>Итоговый вес турнира для этих игроков: <code>W = K<sub>количество игроков</sub> + K<sub>усредненное количество ханчанов</sub> = 0.7 + 2.03 = 2.73</code>.</i></p>
        <p><i>Для игроков, прошедших во второй этап, <code>K<sub>усредненное количество ханчанов</sub> = (K<sub>20 ханчанов</sub> + W<sub>среднее по числу ханчанов</sub>) / 2 = (2.8 + 2.16) / 2 = 2.48</code>.</i></p>
        <p><i>Итоговый вес турнира для этих игроков: <code>W = K<sub>количество игроков</sub> + K<sub>усредненное количество ханчанов</sub> = 0.7 + 2.48 = 3.18</code>.</i></p>
        <p><i>2. Турнир из четырех этапов, в каждом по 5 ханчанов. В первом этапе стартуют 32 игрока, далее в каждом этапе половина игроков отсекается. Для такого турнира:</i></p>
        <p><i><code>W<sub>среднее по числу ханчанов</sub> = (16 * 1 + 8 * 1.9 * 4 * 2.5 + 4 * 2.8) / 32 = 1.64</code>.</i></p>
        <p><i>Для игроков, отсеявшихся в 1 туре: <code>W = 0.8 + (1 + 1.64) / 2 = 2.12</code>.</i></p>
        <p><i>Для игроков, отсеявшихся во 2 туре: <code>W = 0.8 + (1.9 + 1.64) / 2 = 2.57</code>.</i></p>
        <p><i>Для игроков, отсеявшихся в 3 туре: <code>W = 0.8 + (2.5 + 1.64) / 2 = 2.87</code>.</i></p>
        <p><i>Для финалистов: <code>W = 0.8 + (2.8 + 1.64) / 2 = 3.02</code>.</i></p>

        <h1 id="crr">Общий рейтинг (CRR)</h1>
        <p>Все расчёты идентичны рейтингу RR. Отличие CRR только в требованиях к турнирам: в нём учитываются все российские турниры на 12+ игроков и 3+ ханчанов и официальные ЕМА турниры, если в них участвовал игрок из России.</p>

        <h1 id="online">Онлайн рейтинг</h1>
        <p>Все расчёты для онлайн рейтинга идентичны рейтингу RR с небольшими отличиями:</p>
        <ol>
            <li>В зачёт идут турниры на 12+ игроков и 3+ ханчанов.</li>
            <li>В рейтинг игрок попадает уже после первого турнира, а не после второго.</li>
            <li>В правую часть формулы подставляются три лучших турнира, а не четыре.</li>
            <li>В зачёт идут турниры за последние два с половиной года. Результаты турниров, проведенных за последние 12 месяцев, считаются актуальными и учитываются полностью. Далее турнир устаревает на 25% каждые 6 месяцев.</li>
        </ol>
    </div>
{% endblock %}
